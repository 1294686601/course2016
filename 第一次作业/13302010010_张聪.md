# 前端 MVVM 框架和思想

> BY 13302010010 张聪([dancerphil@github](https://github.com/dancerphil/trick/))，除非另行注明，页面上所有内容采用 [MIT](https://opensource.org/licenses/MIT) 协议共享

## MVVM 做到了什么？

大约两周前，我看到了一个有趣的页面。[WEB开发技能树](http://www.dungeonsanddevelopers.com/)。

这是一个 RPG 风格的技能树，比如你可以点出 HTML 技能，然后可以再学习 JS 技能，技能有等级，有先后关系，而我想的则是，这样的一个效果，换做是我，要如何实现？

我们想到了“类”。技能与技能之间有很多相同的地方，而其中的文字改变了。

怎么把这些数据映射到页面上，怎么理清技能之间的逻辑关系，如何和用户的操作联系并回馈。对于原生 JS 来说，是有一些困难的。

## MVVM 的历史

想必大家都了解过 MVC ，这是一种通过 Controller 在中间同时控制 Model 和 View ，从而实现 Model 和 View 之间的分离。

然而当我们很经常的说到 MVP 和 MVVM 时，我们是在说一个与 MVC 完全对立的模型吗？不是。

MVC 是一个较为宽泛的概念，任何一个成体系的 WEB 项目，或多或少的用到了 MVC 的思想。其最基本的思想就是分离 Model 和 View ，在一个 web 项目中， Model 的动态数据只是占了一部分，就如同上一节的应用，很多操作甚至不会与数据本身有关，Model 和 View 并不对应，而且随着项目的复杂化，两者之间的逻辑越来越复杂，如果没有一个 Controller 的抽象，项目的逻辑很快就会崩溃。

一个可能的模型是这样的：

也或者：

MVP 是这样的：

MVVM 是这样的：

可以说 MVP 和MVVM 都是特殊的 MVC ，然后我们解释一下最后两张图。

### MVP

在 MVP *(Model-View-Presenter)* 模型中，Model 和 View 完全的分离开来，用户对 View 的改变首先交给 Presenter ，由 Presenter 负责提炼其中的逻辑，然后对 Model 进行操作，而 Model 的改变也首先交给 Presenter ，通过 Presenter 更改 View 视图。

与传统 MVC 的思想不同，MVP 并不在意 Presenter 是否很大，因为把逻辑交给 Presenter 意味着 View 和 Model 的规模达到最简洁，在 MVP 架构下，程序员最常写代码的部分就是 Presenter 。

不得不说 Presenter 的取名非常形象。它是整个系统的逻辑中枢，而呈现出来的 PPT 就是它的结晶。

### MVVM

MVVM *(Model-View-ViewModel)*  和 MVP 有些类似，只是这一次，View 和 ViewModel 之间的联系更为紧密，它采用双向绑定（data-binding），所有对 ViewModel 的操作，都直接的绑定到了 View 上，所有对 View 的操作，也都直接的绑定到了 ViewModel 上。

不得不说这种双向绑定的实现，着实需要一些功夫，这就是我们各种 MVVM 库做的事情，这些换来了程序员的便利，在 Angular 中，我们只要给标签添加一条属性，就不再管这个标签内容究竟如何同步了；在 React 中，render 自动同步，还使用 virtual DOM ，比大部分程序员的水平不知道高到哪里去了。

## MVVM 库的使用

### knockout


